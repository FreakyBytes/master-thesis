% !TeX spellcheck = en_US

\section{Introduction into Building Automation}
	\begin{itemize}
		\item Increasing amount of complexity and requirement of comfort in private and commercial buildings \parencite{Merz2009}

		\item benefits regarding saving and managing energy \parencite{Merz2009}
		\item Ever changing requirements: "in commercial buildings flexibility is high on the agenda -- offices buildings, for example, should be designed in such way that they can be easily adapted to meet any change in use or requirements" \parencite{Merz2009}
		\item "In modern buildings there are variety of automation systems for heating, ventilating and air conditioning" \parencite{Merz2009}
		\item "control systems optimize energy consumption and enable support and maintenance personnel to carry out their jobs more efficiently" \parencite{Merz2009}
		
	\end{itemize}

\section{\knx}
	\alert{telegram vs frame. frame is used in the english standard document}
	
	\begin{itemize}
		\item \knx or Konnex
		\item "formerly known as European Installation Bus (EIB)" \parencite{Merz2009}
		\item "designed to be used in electrical installations for implementing automated functions and processes in buildings" \parencite{Merz2009}
		\item "Different transmission media can be used for the bus: twisted-pair cable (KNX.TP), power line (KNX.PL), radio frequency (KNX.RF) and fiber-optic cable" \parencite{Merz2009}
		\item focus on KNX.TP
			\subitem 2 variants
			\subitem TP-0: 2400 Baud unbalanced, derived from BatiBUS \parencite{CENELEC2004}
			\subitem TP-1: 9600 Baud balanced, derived from EIB (relevant here) \parencite{CENELEC2004}
		\item KNX.PL and KNX.RF for integration into older buildings \parencite{Merz2009}
		\item Standardized as DIN EN 50090 written by \textcite{CENELEC2004}
		\item "Large sections was approved for inclusion into ISO/IEC 14543" \parencite{Merz2009}
		\item "World wide only open standard for home and building control" \parencite{Merz2009}
		\item Benefits of \knx include
			\subitem more devices due to different manufactures
			\subitem large variety of devices (sensors, actuators, control/regulation, operation and monitoring)
	\end{itemize}
	
	\subsection{Bus Topology of KNX Networks}
	\begin{itemize}
		\item "Like a conventional electrical installation, a KNX installation needs to have a power line network to provide the loads with electricity. But it also has a communication network â€“ the KNX installation bus" \parencite{Merz2009}
		\item "Both networks are galvanically isolated" \parencite{Merz2009}
		\item 2 separate cable installations as a result
		\item \knx is designed to reshape the structure of conventional building installations, in form of a tree topology \parencite{Merz2009}
		\item "Nodes are assigned to a line" \parencite{Merz2009}
		\item "Several lines are connected to a main line and form an area" \parencite{Merz2009}
		\item "Several areas are connected with each other via the back bone line" \parencite{Merz2009}
		\item Each node is assigned an address, defining area, line, and device number which forms the logical topology
			\subitem cf. Table~\ref{tab:background:bas:knx:topo:addr}
		\item It is advised, that the physical topology reassembles the logical \parencite{Sokollik2017}
		\item Even though, the physical \knx bus can build in various forms (star, tree, and mixed forms) \parencite{Sokollik2017}
		\item Most significant subdivision of the physical topology in \knx.TP-1 is a line segment \parencite{Sokollik2017}
			\subitem a segment defines how many \knx devices can be connected on a physical line \parencite{Sokollik2017}
			\subitem segment is a part of the bus system, which connects \knx devices electrical continuous with each other. \parencite{Sokollik2017}
		\item 2 types of \knx.TP-1 devices \parencite{Sokollik2017}
			\subitem TP1-64 and TP1-256 cf. Table \ref{tab:background:bas:knx:topo:tpsegments}
			\subitem mainly differ in the maximum amount of devices, which can be connected in one segment
			\subitem problem since market is very fragmented
			\subitem products are often not clearly with regards to TP1-64 and TP1-256
			\subitem better of assuming TP1-64 for installations, since one TP1-64 device in a segment forces the whole segment to be downgraded to the TP1-64 standard
		\item therefore max a full logical line must be build in four segments with 3 line repeaters \parencite{Sokollik2017}
			\subitem it is to note that is not to advice since a \knx telegram can only take 6 hops
			\subitem e.g. can be transmitted by max 6 couplers
		\item area is created by coupling up to 16 lines \parencite{Sokollik2017}
			\subitem 1 main line and 15 sublines
			\subitem lines are coupled via line couplers to the main line
			\subitem line couplers have own physical address (device address 0) \parencite{Sokollik2017}
			\subitem line couplers galvanically separate main line and sub line, are capable of routing \parencite{Sokollik2017}
		\item all main lines are connected via backbone couplers to the backbone line \parencite{Merz2009}
		
			
	\end{itemize}
	
	\begin{table}
		\aboverulesep=0ex
		\belowrulesep=0ex
		\renewcommand{\arraystretch}{1.2}
		
		\centering
		\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
			\toprule
			Byte & \multicolumn{8}{c|}{1} & \multicolumn{8}{c|}{0} \\\midrule
			Bit & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0\\\midrule
			Physical Address & \multicolumn{4}{c|}{area} & \multicolumn{4}{c|}{line} & \multicolumn{8}{c|}{device}\\\midrule
			Group Address & \multicolumn{5}{c|}{main} & \multicolumn{3}{c|}{middle} & \multicolumn{8}{c|}{sub group}\\
			\bottomrule
		\end{tabular}
		\caption[Bit field for \knx addresses]{Bit field for \knx addresses. Only the most common used 3-level group address is shown here. cf.~\textcite{Merz2009,Sokollik2017} }
		\label{tab:background:bas:knx:topo:addr}
	\end{table}
	
	\begin{table}
		\centering
		\begin{tabular}{l r r }
			 & \textbf{TP1-64} & \textbf{TP1-256} \\\toprule
			 maximum devices per segment & 64 & 256 \\
			 maximum distance between 2 devices & 700m & 700m \\
			 maximum length of a physical line & 1000m & 1000m \\
			 \bottomrule
		\end{tabular}
		\caption[Segment properties for \knx.TP1-64 and \knx.TP1-256]{Segment properties for \knx.TP1-64 and \knx.TP1-256. cf. \textcite{Sokollik2017}}
		\label{tab:background:bas:knx:topo:tpsegments}
	\end{table}
	
	\subsection{KNX Protocol}
		\begin{itemize}
			\item 3 types of telegrams \parencite{Hubner2009} \parencite{Merz2009}
				\subitem data - "sent in response to an individual action such as" \parencite{Merz2009} pressing a button (standard and extended \parencite{Hubner2009})
				\subitem acknowledge - "All devices (receivers) that belong to this group simultaneously confirm that they have received the data frame by returning an acknowledgment frame." \parencite{Merz2009}
				\subitem poll - "one device can query 1-Byte-Information from up to 15 other devices. Addressing is done via group addresses" \parencite{Hubner2009}
			\item Data Telegram
				\subitem 
			
		\end{itemize}
	
		\begin{table}
			\aboverulesep=0ex
			\belowrulesep=0ex
			\renewcommand{\arraystretch}{1.2}
			\newcolumntype{Y}{>{\centering\arraybackslash}X}
			
			\centering
			\begin{tabularx}{\textwidth}{|l|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|}
				\toprule
				Byte & \multicolumn{8}{c|}{0} & \multicolumn{8}{c|}{1} & \multicolumn{8}{c|}{2} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{8}{c|}{CTRL} & \multicolumn{16}{c|}{Source Address} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{3} & \multicolumn{8}{c|}{4} & \multicolumn{8}{c|}{5} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{16}{c|}{Destination Address} & \multicolumn{1}{c|}{\parbox[t][][t]{0.1cm}{A T}} & \multicolumn{3}{c|}{Hops} & \multicolumn{4}{c|}{Length} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{6} & \multicolumn{8}{c|}{$7+n$} & \multicolumn{8}{c|}{$8+n$} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{16}{c|}{Payload $n+1$ Bytes} & \multicolumn{8}{c|}{Parity} \\\bottomrule
			\end{tabularx}
			\caption[Standard \knx data telegram]{Standard \knx data telegram with $2$ to $16$ Bytes of payload. Control Byte (CTRL) cf. Table~\ref{tab:background:bas:knx:proto:ctrl}, Source Address, Destination Address cf. Table~\ref{tab:background:bas:knx:topo:addr}, Address Type (AT), Hop Count (Hops), Payload Length (Length), Payload, and Parity.}
			\label{tab:background:bas:knx:proto:knx-standard}
		\end{table}
	
		\begin{table}
			\aboverulesep=0ex
			\belowrulesep=0ex
			\renewcommand{\arraystretch}{1.2}
			\newcolumntype{Y}{>{\centering\arraybackslash}X}
			
			\centering
			\begin{tabularx}{\textwidth}{|l|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|}
				\toprule
				Byte & \multicolumn{8}{c|}{0} & \multicolumn{8}{c|}{1} & \multicolumn{8}{c|}{2} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{8}{c|}{CTRL} & \multicolumn{8}{c|}{CTRLE} & \multicolumn{8}{c|}{Source Address} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{3} & \multicolumn{8}{c|}{4} & \multicolumn{8}{c|}{5} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{8}{c|}{Source Address} & \multicolumn{16}{c|}{Destination Address} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{6} & \multicolumn{8}{c|}{$7$} & \multicolumn{8}{c|}{$8+n$} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{8}{c|}{Length} & \multicolumn{16}{c|}{Payload $n+1$ Bytes} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{$9+n$} & \multicolumn{16}{c|}{ } \\\cmidrule{1-9}
				Bit & & & & & & & & & \multicolumn{16}{c|}{ } \\\cmidrule{1-9}
				Function & \multicolumn{8}{c|}{Parity} & \multicolumn{16}{c|}{ } \\\bottomrule
			\end{tabularx}
			\caption[Extended \knx data telegram]{Extended \knx data telegram with $2$ to $255$ Bytes of payload. Control Byte (CTRL) cf. Table~\ref{tab:background:bas:knx:proto:ctrl}, Extended Control Byte (CTRLE) cf. Table~\ref{tab:background:bas:knx:proto:ctrle}, Source Address, Destination Address cf. Table~\ref{tab:background:bas:knx:topo:addr}, Payload Length (Length), Payload, and Parity.}
			\label{tab:background:bas:knx:proto:knx-extended}
		\end{table}
		
		\begin{table}
			\aboverulesep=0ex
			\belowrulesep=0ex
			\renewcommand{\arraystretch}{1.2}
			\newcolumntype{Y}{>{\centering\arraybackslash}X}
			
			\centering
			\begin{tabularx}{\textwidth}{|l|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|Y|}
				\toprule
				Byte & \multicolumn{8}{c|}{0} & \multicolumn{8}{c|}{1} & \multicolumn{8}{c|}{2} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{8}{c|}{CTRL} & \multicolumn{16}{c|}{Source Address} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{3} & \multicolumn{8}{c|}{4} & \multicolumn{8}{c|}{5} \\\midrule
				Bit & & & & & & & & & & & & & & & & & & & & & & & & \\\midrule
				Function & \multicolumn{16}{c|}{Destination Address} & \multicolumn{4}{c|}{ } & \multicolumn{4}{c|}{poll data} \\\bottomrule
				\toprule
				Byte & \multicolumn{8}{c|}{6} & \multicolumn{16}{c|}{ } \\\cmidrule{1-9}
				Bit & & & & & & & & & \multicolumn{16}{c|}{ } \\\cmidrule{1-9}
				Function & \multicolumn{8}{c|}{Parity} & \multicolumn{16}{c|}{ } \\\bottomrule
			\end{tabularx}
			\caption[\knx poll telegram]{\knx poll telegram. Control Byte (CTRL) cf. Table~\ref{tab:background:bas:knx:proto:ctrl}, Source Address, Destination Address cf. Table~\ref{tab:background:bas:knx:topo:addr}, expected length of poll data (poll data), and Parity.}
			\label{tab:background:bas:knx:proto:knx-poll}
		\end{table}
	
		\begin{table}
			\aboverulesep=0ex
			\belowrulesep=0ex
			\renewcommand{\arraystretch}{1.2}
			\newcolumntype{Y}{>{\centering\arraybackslash}X}
			
			\centering
			\begin{tabularx}{0.7\textwidth}{|l|Y|Y|Y|Y|Y|Y|Y|Y|}
				\toprule
				Byte & \multicolumn{8}{c|}{0} \\\midrule
				Bit & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\\bottomrule
				\toprule
				ACK  & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 0 \\\midrule
				NACK & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 \\\midrule
				BUSY & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\midrule
				NACK + BUSY & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\bottomrule
			\end{tabularx}
			\caption[\knx acknowledge telegram]{\knx short acknowledge telegram.}
			\label{tab:background:bas:knx:proto:ack}
		\end{table}
		
		\begin{table}
			\aboverulesep=0ex
			\belowrulesep=0ex
			\renewcommand{\arraystretch}{1.2}
			\newcolumntype{Y}{>{\centering\arraybackslash}X}
			
			\centering
			\begin{tabularx}{\textwidth}{|l|Y|Y|Y|Y|Y|Y|Y|Y|}
				\toprule
				Byte & \multicolumn{8}{c|}{0} \\\midrule
				Bit & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\\midrule
				Function & \multicolumn{2}{c|}{TT} & R & A & \multicolumn{2}{c|}{P} & \multicolumn{2}{c|}{reserved} \\\bottomrule \toprule
				Standard Data Telegram & 1 & 0 & R & 1 & \multicolumn{2}{c|}{P} & \multicolumn{2}{c|}{ } \\\midrule
				Extended Data Telegram & 0 & 0 & R & 1 & \multicolumn{2}{c|}{P} & \multicolumn{2}{c|}{ } \\\midrule
				Poll Telegram & 1 & 1 & 1 & 1 & 0 & 0 & \multicolumn{2}{c|}{ } \\\midrule
				Acknowledge Telegram & \multicolumn{2}{c|}{ } & 0 &0 & \multicolumn{2}{c|}{ } & \multicolumn{2}{c|}{ } \\\bottomrule
			\end{tabularx}
			\caption[\knx CTRL Byte]{\knx CTRL Byte. Telegram Type (TT), Repeat (R), Acknowledge (A), and Priority (P). cf. \textcite{Sokollik2017}}
			\label{tab:background:bas:knx:proto:ctrl}
		\end{table}
	
		\begin{table}
			\aboverulesep=0ex
			\belowrulesep=0ex
			\renewcommand{\arraystretch}{1.2}
			\newcolumntype{Y}{>{\centering\arraybackslash}X}
			
			\centering
			\begin{tabularx}{0.7\textwidth}{|l|Y|Y|Y|Y|Y|Y|Y|Y|}
				\toprule
				Byte & \multicolumn{8}{c|}{0} \\\midrule
				Bit & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\\midrule
				Function & AT & \multicolumn{3}{c|}{Hops} & \multicolumn{4}{c|}{EFF} \\\bottomrule
			\end{tabularx}
			\caption[\knx CTRLE Byte]{\knx CTRLE Byte. Address Type (AT), Hop Count, and Extended Frame Format (EFF). cf. \textcite{Sokollik2017}}
			\label{tab:background:bas:knx:proto:ctrle}
		\end{table}
	
	\subsection{Security in KNX}
	\begin{itemize}
		\item copulers allow filtering 
			\subitem "This means that data frames transmitted by a sender are only forwarded to recipients that are not on the senderâ€™s line." \parencite{Merz2009}
			\subitem "The filter function only forwards data frames to where they are needed. This reduces the overall amount of data frame traffic and keeps the data traffic on one line separate from the data traffic on another line, allowing data to be transferred on several lines simultaneously." \parencite{Merz2009}
		\item main group 14 and 15 should not be used \parencite{Hubner2009}
			\subitem can not be filtered due to limited space for filter tables in couplers \parencite{Hubner2009}
			
			
	\end{itemize}
	
	\subsection{Examples and Applications of KNX Networks}

\section{\lonworks}

\section{\bacnet}